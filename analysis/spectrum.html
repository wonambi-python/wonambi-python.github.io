<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frequency Domain &mdash; wonambi 7.11 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/wonambi.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plot 3D images" href="plot3d.html" />
    <link rel="prev" title="Get Started" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> wonambi
            <img src="../_static/wonambi.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                7.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">WONAMBI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#run-it">Run it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#change-log">Change Log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#optional-requirements">Optional Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#status">Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#linux-mac-os-x">Linux / Mac OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial / Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Get Started</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Frequency Domain</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot3d.html">Plot 3D images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cmd.html">Command Line</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cmd.html#wonambi">wonambi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmd.html#won-convert">won_convert</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gui/index.html">Graphical User Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gui/open.html">Open Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/labels.html">Edit Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/channels.html">Plot Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/traces.html">Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/notes.html">Annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/detect.html">Event detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/methods.html">Detection methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/analysis.html">Analysis console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/screenshot.html">Screenshot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/wonambi.html">Modules, classes, functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/wonambi.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/wonambi.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#prepare-test-environment">Prepare Test Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#get-files">1. Get Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#run-the-tests">2. Run the Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#coverage">3. Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#documentation">4. Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#release">5. Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#tips-and-tricks">Tips and Tricks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-7">Version 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-6">Version 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-5">Version 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-4">Version 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-3">Version 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2">Version 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1">Version 1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">TODO</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">wonambi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorial / Analysis</a></li>
      <li class="breadcrumb-item active">Frequency Domain</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script><section id="frequency-domain">
<span id="powerspectrum"></span><h1>Frequency Domain<a class="headerlink" href="#frequency-domain" title="Permalink to this heading"></a></h1>
<section id="frequency">
<h2>Frequency<a class="headerlink" href="#frequency" title="Permalink to this heading"></a></h2>
<p>Let’s create a signal with amplitude of 1 V and a frequency of 10 Hz:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
    <span class="c1"># generate data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n_chan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="s1">&#39;sine&#39;</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitude (V)&#39;</span><span class="p">),</span>
</pre></div>
</div>
<div>                            <div id="7e344ad8-d130-4763-98ff-44f356cdf18b" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7e344ad8-d130-4763-98ff-44f356cdf18b")) {                    Plotly.newPlot(                        "7e344ad8-d130-4763-98ff-44f356cdf18b",                        [{"x":[0.0,0.00390625,0.0078125,0.01171875,0.015625,0.01953125,0.0234375,0.02734375,0.03125,0.03515625,0.0390625,0.04296875,0.046875,0.05078125,0.0546875,0.05859375,0.0625,0.06640625,0.0703125,0.07421875,0.078125,0.08203125,0.0859375,0.08984375,0.09375,0.09765625,0.1015625,0.10546875,0.109375,0.11328125,0.1171875,0.12109375,0.125,0.12890625,0.1328125,0.13671875,0.140625,0.14453125,0.1484375,0.15234375,0.15625,0.16015625,0.1640625,0.16796875,0.171875,0.17578125,0.1796875,0.18359375,0.1875,0.19140625,0.1953125,0.19921875,0.203125,0.20703125,0.2109375,0.21484375,0.21875,0.22265625,0.2265625,0.23046875,0.234375,0.23828125,0.2421875,0.24609375,0.25,0.25390625,0.2578125,0.26171875,0.265625,0.26953125,0.2734375,0.27734375,0.28125,0.28515625,0.2890625,0.29296875,0.296875,0.30078125,0.3046875,0.30859375,0.3125,0.31640625,0.3203125,0.32421875,0.328125,0.33203125,0.3359375,0.33984375,0.34375,0.34765625,0.3515625,0.35546875,0.359375,0.36328125,0.3671875,0.37109375,0.375,0.37890625,0.3828125,0.38671875,0.390625,0.39453125,0.3984375,0.40234375,0.40625,0.41015625,0.4140625,0.41796875,0.421875,0.42578125,0.4296875,0.43359375,0.4375,0.44140625,0.4453125,0.44921875,0.453125,0.45703125,0.4609375,0.46484375,0.46875,0.47265625,0.4765625,0.48046875,0.484375,0.48828125,0.4921875,0.49609375,0.5,0.50390625,0.5078125,0.51171875,0.515625,0.51953125,0.5234375,0.52734375,0.53125,0.53515625,0.5390625,0.54296875,0.546875,0.55078125,0.5546875,0.55859375,0.5625,0.56640625,0.5703125,0.57421875,0.578125,0.58203125,0.5859375,0.58984375,0.59375,0.59765625,0.6015625,0.60546875,0.609375,0.61328125,0.6171875,0.62109375,0.625,0.62890625,0.6328125,0.63671875,0.640625,0.64453125,0.6484375,0.65234375,0.65625,0.66015625,0.6640625,0.66796875,0.671875,0.67578125,0.6796875,0.68359375,0.6875,0.69140625,0.6953125,0.69921875,0.703125,0.70703125,0.7109375,0.71484375,0.71875,0.72265625,0.7265625,0.73046875,0.734375,0.73828125,0.7421875,0.74609375,0.75,0.75390625,0.7578125,0.76171875,0.765625,0.76953125,0.7734375,0.77734375,0.78125,0.78515625,0.7890625,0.79296875,0.796875,0.80078125,0.8046875,0.80859375,0.8125,0.81640625,0.8203125,0.82421875,0.828125,0.83203125,0.8359375,0.83984375,0.84375,0.84765625,0.8515625,0.85546875,0.859375,0.86328125,0.8671875,0.87109375,0.875,0.87890625,0.8828125,0.88671875,0.890625,0.89453125,0.8984375,0.90234375,0.90625,0.91015625,0.9140625,0.91796875,0.921875,0.92578125,0.9296875,0.93359375,0.9375,0.94140625,0.9453125,0.94921875,0.953125,0.95703125,0.9609375,0.96484375,0.96875,0.97265625,0.9765625,0.98046875,0.984375,0.98828125,0.9921875,0.99609375],"y":[0.4950103490041062,0.46304061725207407,0.40331739146190315,0.3194203320978147,0.21637801861941797,0.1003665490324781,-0.02166063994584519,-0.14238954445580612,-0.2545839765546865,-0.3515192831853798,-0.427385405026037,-0.47763511688354904,-0.49925657697450615,-0.49095384917284807,-0.45322457817313977,-0.3883301619148706,-0.30016020905790436,-0.19399940558828005,-0.07621076398568746,0.04614575979638001,0.16573642239548128,0.27539325923615793,0.3685437143608792,0.43960458296075344,0.48431665467808976,0.5,0.4857145985164542,0.4423166813876015,0.37240741099408003,0.2801769737834441,0.17115343099673896,0.051871380533180314,-0.07051971046967417,-0.1886840267768092,-0.2955390954345289,-0.3846802914478661,-0.45076471495030357,-0.4898314312303823,-0.4995388792306662,-0.47930521884866,-0.43034320497423517,-0.3555874980011681,-0.2595187676385353,-0.1478951327986567,-0.027407034381572836,0.09472377298364974,0.21117707481086417,0.3149729520658306,0.3998901400187413,0.4608389152592125,0.49416616096067467,0.4978743255468276,0.4717411509264805,0.41733299408647295,0.337910943579785,0.2382353580512259,0.12428054227157882,0.0028766622835674624,-0.1186996376316851,-0.23316137877477258,-0.3336480112672334,-0.4141366182160724,-0.4698029142565406,-0.4973104011253694,-0.49501034900410623,-0.46304061725207407,-0.4033173914619039,-0.31942033209781523,-0.21637801861941822,-0.10036654903247796,0.021660639945843996,0.1423895444558054,0.25458397655468623,0.3515192831853799,0.4273854050260364,0.4776351168835488,0.49925657697450615,0.49095384917284796,0.4532245781731401,0.38833016191487074,0.30016020905790425,0.19399940558828116,0.0762107639856882,-0.04614575979637971,-0.16573642239548142,-0.27539325923615693,-0.3685437143608787,-0.4396045829607533,-0.4843166546780899,-0.5,-0.48571459851645427,-0.44231668138760166,-0.37240741099407965,-0.2801769737834451,-0.17115343099673924,-0.05187138053318062,0.070519710469673,0.18868402677680893,0.29553909543452866,0.3846802914478665,0.45076471495030307,0.48983143123038225,0.4995388792306662,0.47930521884865984,0.4303432049742358,0.35558749800116835,0.2595187676385356,0.14789513279865615,0.02740703438157403,-0.09472377298364945,-0.2111770748108639,-0.3149729520658311,-0.3998901400187411,-0.4608389152592124,-0.4941661609606748,-0.4978743255468277,-0.4717411509264806,-0.4173329940864731,-0.33791094357978463,-0.23823535805122695,-0.12428054227157911,-0.0028766622835677685,0.11869963763168567,0.23316137877477075,0.3336480112672332,0.4141366182160732,0.46980291425654047,0.4973104011253692,0.495010349004106,0.4630406172520742,0.40331739146190404,0.3194203320978141,0.2163780186194185,0.10036654903247653,-0.021660639945845467,-0.1423895444558085,-0.2545839765546875,-0.35151928318537967,-0.42738540502603806,-0.47763511688354926,-0.4992565769745061,-0.4909538491728477,-0.45322457817313944,-0.3883301619148687,-0.3001602090579031,-0.1939994055882798,-0.07621076398568499,0.04614575979638117,0.16573642239548111,0.27539325923615965,0.3685437143608797,0.43960458296075317,0.48431665467809026,0.5,0.4857145985164535,0.442316681387601,0.37240741099407987,0.28017697378344236,0.17115343099673785,0.05187138053318092,-0.0705197104696762,-0.1886840267768103,-0.2955390954345284,-0.3846802914478674,-0.4507647149503037,-0.4898314312303829,-0.49953887923066614,-0.4793052188486599,-0.4303432049742341,-0.3555874980011673,-0.2595187676385358,-0.14789513279865474,-0.027407034381572562,0.09472377298365263,0.21117707481086523,0.3149729520658308,0.39989014001874307,0.46083891525921294,0.4941661609606747,0.4978743255468274,0.4717411509264801,0.4173329940864733,0.3379109435797835,0.23823535805122564,0.12428054227157598,0.0028766622835662984,-0.11869963763168537,-0.2331613787747736,-0.3336480112672343,-0.41413661821607206,-0.469802914256541,-0.4973104011253693,-0.4950103490041063,-0.4630406172520736,-0.4033173914619032,-0.31942033209781295,-0.2163780186194172,-0.10036654903247857,0.021660639945846934,0.1423895444558065,0.25458397655468573,0.3515192831853807,0.427385405026037,0.4776351168835497,0.4992565769745062,0.49095384917284807,0.4532245781731388,0.38833016191487,0.30016020905790475,0.19399940558827844,0.07621076398568705,-0.046145759796379096,-0.1657364223954825,-0.27539325923615793,-0.3685437143608807,-0.43960458296075383,-0.48431665467808976,-0.5,-0.485714598516454,-0.44231668138760194,-0.37240741099407887,-0.2801769737834441,-0.1711534309967365,-0.05187138053317946,0.07051971046967415,0.18868402677681165,0.2955390954345296,0.3846802914478661,0.45076471495030435,0.4898314312303825,0.49953887923066626,0.4793052188486595,0.43034320497423517,0.3555874980011663,0.2595187676385346,0.14789513279865674,0.027407034381571094,-0.09472377298365059,-0.21117707481086334,-0.314972952065832,-0.3998901400187418,-0.4608389152592121,-0.49416616096067495,-0.4978743255468276,-0.47174115092647967,-0.41733299408647245,-0.3379109435797851,-0.23823535805122437,-0.12428054227157799,-0.002876662283568381,0.1186996376316868,0.23316137877477178,0.33364801126723537,0.4141366182160729,0.4698029142565391,0.49731040112536945],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"title":{"text":"Time (s)"}},"yaxis":{"title":{"text":"Amplitude (V)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
<p>We can transform it to the frequency-domain, by computing the power spectral density (default option):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">save_plotly_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;freq_01_data&#39;</span><span class="p">)</span>

    <span class="c1"># default options</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">freq</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</pre></div>
</div>
<div>                            <div id="bb0ffb48-f07d-4c58-8cbf-e4b59f15ca8d" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("bb0ffb48-f07d-4c58-8cbf-e4b59f15ca8d")) {                    Plotly.newPlot(                        "bb0ffb48-f07d-4c58-8cbf-e4b59f15ca8d",                        [{"x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0,105.0,106.0,107.0,108.0,109.0,110.0,111.0,112.0,113.0,114.0,115.0,116.0,117.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,125.0,126.0,127.0,128.0],"y":[1.9400248563375643e-37,1.5391397167672518e-33,1.9877711249965124e-34,9.079584716371468e-34,1.9782243174367425e-33,7.520181681469179e-34,5.359242010856211e-34,6.085270583306374e-33,7.067982919806317e-33,6.448825818175797e-32,0.12500413759294685,7.304486502043076e-32,5.633610368532185e-33,9.620595475862777e-33,2.3099421259027724e-33,5.4778658159367236e-33,9.061225656103281e-33,3.523567342443313e-33,4.1382269970656265e-34,1.999994918467507e-33,1.912435483366504e-34,1.1517293329881853e-33,1.3030117674768126e-34,2.2616006279225714e-34,2.3774285763290776e-34,2.8536931351272994e-34,3.899638507558385e-33,2.3067505320917408e-34,6.324216697793479e-35,1.7395263685516321e-34,9.446317147996324e-35,6.917015625767554e-34,1.8215716372410913e-33,1.3133750387891133e-34,5.878161052748277e-34,1.7949855130732605e-33,4.1769757212215846e-33,1.6347415804934177e-33,1.8229739905520452e-34,2.2012199078841495e-34,4.953160860510331e-34,5.705016325552841e-34,1.8970496525973677e-33,1.754426729956712e-33,1.1640453989105722e-34,2.113975025703637e-33,1.2363924598610192e-34,4.9525046249526544e-34,9.749336075279943e-34,8.77513191337935e-34,2.3868754206286503e-34,2.0267619761655358e-33,2.1326629815886885e-33,2.2571125928164107e-34,3.009265538105056e-35,4.219522572347933e-34,5.769175480552565e-34,1.0248398604542137e-32,1.4406882423425396e-33,1.2645055110359528e-32,1.1161607368375703e-33,4.563408632659407e-34,1.06687770129527e-34,4.4499495140037984e-33,1.3660126895673059e-33,3.1936915644744382e-34,1.5134269867225664e-35,4.80917955946136e-34,2.413702059853676e-33,1.185206809791125e-33,1.3723647623512638e-34,1.484591884215825e-33,1.4087952186358547e-34,4.939962740456192e-35,2.2268564981977415e-34,4.924031233164511e-33,1.0113520217502364e-33,8.848779214101147e-33,4.023894500618081e-33,1.2348949116144496e-32,1.0127781066349044e-33,4.5120268257570054e-33,1.4253286622803595e-34,1.7318426386622374e-32,4.8104186201099575e-32,1.541269530290644e-32,6.569071407396585e-34,3.023148831025696e-33,9.215780583703194e-34,5.132437279149311e-34,1.6825517669466517e-34,1.6947519653298094e-33,5.497729555993399e-34,1.6819379597655208e-33,7.840476457436309e-34,3.002919943397129e-34,5.2866493168994915e-34,3.029870893861728e-34,5.064061080008906e-34,1.4031903021458863e-33,1.9241509773523304e-33,4.937501332780347e-34,7.933379585558195e-34,1.1422667794786235e-32,3.7469976704661513e-32,1.747390390960969e-32,4.754708449256017e-34,1.0797620006857516e-33,1.3130947735894465e-33,1.015442096351015e-34,4.1347568386331625e-33,5.939184611430656e-33,1.1105646410776787e-33,1.831099791521848e-33,1.6752176410564763e-33,2.0950908649362658e-34,9.368476053922066e-35,1.818842931601619e-33,6.018531076210112e-34,1.9279691647813237e-33,1.1531730348906947e-33,5.823156680937719e-34,4.0785205619933237e-35,1.65122718613303e-34,9.09164190908967e-34,2.9833487129070484e-33,3.4148443089327755e-33,7.851492958402929e-34,1.0847466461162877e-34],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"range":[0,20],"title":{"text":"Frequency (Hz)"}},"yaxis":{"title":{"text":"Amplitude (V<sup>2</sup>/Hz)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
<p>Note that the Parseval’s theorem holds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">p_time</span> <span class="o">=</span> <span class="n">math</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">operator_name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">p_freq</span> <span class="o">=</span> <span class="n">math</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">operator_name</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">)</span>
    <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">p_time</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">p_freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">s_freq</span><span class="p">)</span>
</pre></div>
</div>
<section id="welch-s-method">
<h3>Welch’s Method<a class="headerlink" href="#welch-s-method" title="Permalink to this heading"></a></h3>
<p>If you want to apply the Welch’s method (compute PSD on 1s long, 50% overlapping windows and Hann window) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># generate very long data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n_chan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="s1">&#39;sine&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">taper</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">freq</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">)),</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitude (V&lt;sup&gt;2&lt;/sup&gt;/Hz)&#39;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<div>                            <div id="47980423-9c66-4c6a-a3cf-fd490cdf1d4d" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("47980423-9c66-4c6a-a3cf-fd490cdf1d4d")) {                    Plotly.newPlot(                        "47980423-9c66-4c6a-a3cf-fd490cdf1d4d",                        [{"x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0,105.0,106.0,107.0,108.0,109.0,110.0,111.0,112.0,113.0,114.0,115.0,116.0,117.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,125.0,126.0,127.0,128.0],"y":[3.5781580582556854e-09,2.6731374953200723e-05,1.3199794961099125e-06,8.24987035309174e-08,1.3199785852818743e-08,3.299942865367832e-09,1.077530208847223e-09,4.209088436136352e-10,1.8706964289327035e-10,0.020836443443328044,0.08335333374275661,0.020837073413036658,1.6136446526484946e-11,9.9615482282235e-12,6.375198878772091e-12,4.208469997943032e-12,2.8540565851991653e-12,1.9818740040913858e-12,1.4053355814375998e-12,1.015275300963254e-12,7.458478216685771e-13,5.562441203000374e-13,4.205482090249427e-13,3.2193621948480243e-13,2.492666858562032e-13,1.9502600922785666e-13,1.540622294120766e-13,1.2278837503842176e-13,9.867167746857971e-14,7.990031465246184e-14,6.516245379659058e-14,5.349754985163027e-14,4.419487386401545e-14,3.672336922703361e-14,3.068257611611108e-14,2.5767904991080156e-14,2.174580229862307e-14,1.8435812102232774e-14,1.5697497241755523e-14,1.342081787462995e-14,1.1518994365887533e-14,9.92317107496816e-15,8.57839620098675e-15,7.440571272560616e-15,6.474121414353297e-15,5.650203476141963e-15,4.945320442543651e-15,4.3402427727583894e-15,3.8191645677662815e-15,3.369039657983681e-15,2.9790564836084697e-15,2.6402210613148903e-15,2.3450235508458436e-15,2.0871714149580497e-15,1.8613739215679938e-15,1.6631682093436e-15,1.4887778048317765e-15,1.334997387839304e-15,1.1990984012915315e-15,1.0787516486818319e-15,9.719633278691781e-16,8.7702232063121e-16,7.924563574810758e-16,7.169955242573994e-16,6.495419041358746e-16,5.891440684958123e-16,5.349756723530054e-16,4.863175026520943e-16,4.4254225405777007e-16,4.0310167632184997e-16,3.6751567426124324e-16,3.3536303091811013e-16,3.062734990716418e-16,2.7992105267580394e-16,2.560180955593679e-16,2.3431051380433517e-16,2.1457339279345247e-16,1.9660735482800339e-16,1.8023537045240834e-16,1.653000395307098e-16,1.516611725067057e-16,1.391937646860317e-16,1.2778617454449584e-16,1.1733856533262516e-16,1.077615493241325e-16,9.897496592573949e-17,9.090687673913212e-17,8.349260894125361e-17,7.667397720073059e-17,7.039855990193965e-17,6.461908726355778e-17,5.929287553201164e-17,5.438136063015419e-17,4.984964836317115e-17,4.5666148371358174e-17,4.1802227138094556e-17,3.8231914374167383e-17,3.493163364833697e-17,3.187995915627717e-17,2.905742683539828e-17,2.6446308583035382e-17,2.403048181913656e-17,2.179525474157557e-17,1.972724272943598e-17,1.7814249127764375e-17,1.6045136393721657e-17,1.4409772464902448e-17,1.2898899255884721e-17,1.150408026867413e-17,1.021762424633985e-17,9.032523802898166e-18,7.942395666078731e-18,6.941436834624765e-18,6.02436993184529e-18,5.186413562515771e-18,4.423236301450674e-18,3.7309299813853254e-18,3.105978585776977e-18,2.545233611624313e-18,2.0458873253705917e-18,1.6054598771999597e-18,1.2217742561384685e-18,8.929441193624888e-19,6.173621690274033e-19,3.9368456154310772e-19,2.2082532474802643e-19,9.794761997607321e-20,2.4457421444970805e-20,4.907652285922351e-31],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"range":[0,20],"title":{"text":"Frequency (Hz)"}},"yaxis":{"title":{"text":"Amplitude (V<sup>2</sup>/Hz)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
</section>
<section id="multitapers">
<h3>Multitapers<a class="headerlink" href="#multitapers" title="Permalink to this heading"></a></h3>
<p>A common approach is to use multitaper to suppress the activity outside the frequency band of interest and to smooth the frequency band of interest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># dpss</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n_chan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="s1">&#39;sine&#39;</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">taper</span><span class="o">=</span><span class="s1">&#39;dpss&#39;</span><span class="p">,</span> <span class="n">halfbandwidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">freq</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">)),</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitude (V&lt;sup&gt;2&lt;/sup&gt;/Hz)&#39;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<div>                            <div id="b86c379d-011f-465b-b934-48d90bdaaae1" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b86c379d-011f-465b-b934-48d90bdaaae1")) {                    Plotly.newPlot(                        "b86c379d-011f-465b-b934-48d90bdaaae1",                        [{"x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0,105.0,106.0,107.0,108.0,109.0,110.0,111.0,112.0,113.0,114.0,115.0,116.0,117.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,125.0,126.0,127.0,128.0],"y":[1.6041749024118714e-05,3.443299707716649e-05,4.320837434443947e-05,6.72990978072214e-05,0.00015757305383846737,0.0021353549142693793,0.012866486962229088,0.013308395348298915,0.013456128496372378,0.013525315639066914,0.013557749008908854,0.013562571968241297,0.013532265632370631,0.013426815188060104,0.013030411147090857,0.002005186230471969,0.00011105648586246569,3.9121047171624686e-05,2.0571610173989728e-05,1.3028925850861262e-05,9.177507410251078e-06,6.919161754973486e-06,5.465871591514489e-06,4.4662202500458415e-06,3.7434473288140276e-06,3.200316272358033e-06,2.7794944969779963e-06,2.4452525879162836e-06,2.1742937123386177e-06,1.9508450615808896e-06,1.763883241441869e-06,1.6054921697332946e-06,1.4698523370642878e-06,1.3525972222759742e-06,1.250391180068281e-06,1.160645277158588e-06,1.0813215213838471e-06,1.010795175894269e-06,9.47756113735718e-07,8.911369512292097e-07,8.400598906607388e-07,7.937968549278182e-07,7.517392107197543e-07,7.13374506140906e-07,6.782684061713539e-07,6.460505258197471e-07,6.164032183044213e-07,5.89052626524538e-07,5.637614845116133e-07,5.403232839744968e-07,5.185575145233629e-07,4.9830575491877e-07,4.794284437694737e-07,4.6180219640222973e-07,4.4531756359234604e-07,4.298771499350474e-07,4.1539402661175383e-07,4.0179038644765233e-07,3.889963994025037e-07,3.7694923467246176e-07,3.655922219297675e-07,3.5487412926625003e-07,3.447485394340686e-07,3.3517330920904444e-07,3.2611009931291635e-07,3.1752396444631106e-07,3.093829947093758e-07,3.0165800109944105e-07,2.943222389343566e-07,2.873511640091315e-07,2.807222170864474e-07,2.7441463298239707e-07,2.6840927105942975e-07,2.626884644002109e-07,2.572358853245374e-07,2.5203642523788113e-07,2.470760870774088e-07,2.4234188885610865e-07,2.3782177700454127e-07,2.3350454838150922e-07,2.293797799691016e-07,2.2543776539435218e-07,2.2166945752540492e-07,2.180664164840248e-07,2.146207624961845e-07,2.1132513307096042e-07,2.081726440593511e-07,2.0515685419561613e-07,2.0227173277070427e-07,1.9951163012570305e-07,1.9687125068978305e-07,1.9434562831583425e-07,1.919301036951288e-07,1.8962030365573205e-07,1.8741212216951557e-07,1.8530170291193198e-07,1.8328542323423258e-07,1.813598794227051e-07,1.7952187313187456e-07,1.777683988904343e-07,1.7609663258843578e-07,1.7450392086313863e-07,1.7298777130976781e-07,1.7154584344969393e-07,1.701759403954106e-07,1.6887600115772589e-07,1.6764409354524623e-07,1.6647840761151214e-07,1.653772496087272e-07,1.6433903641162445e-07,1.633622903773681e-07,1.6244563461200266e-07,1.615877886152251e-07,1.6078756427900217e-07,1.6004386221736e-07,1.5935566840704462e-07,1.5872205112052443e-07,1.5814215813484993e-07,1.576152142014613e-07,1.571405187634368e-07,1.5671744390844461e-07,1.563454325465026e-07,1.5602399680361804e-07,1.5575271662256012e-07,1.5553123856436438e-07,1.5535927480380287e-07,1.5523660231444946e-07,1.5516306223890145e-07,7.756927972057474e-08],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"range":[0,20],"title":{"text":"Frequency (Hz)"}},"yaxis":{"title":{"text":"Amplitude (V<sup>2</sup>/Hz)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can either specify the half-bandwidth smoothing in the frequency domain (<code class="docutils literal notranslate"><span class="pre">halfbandwidth</span></code>) or the normalized halfbandwidth (<code class="docutils literal notranslate"><span class="pre">NW</span></code>), where:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NW</span> <span class="o">=</span> <span class="n">halfbandwidth</span> <span class="o">*</span> <span class="n">duration</span>
</pre></div>
</div>
</div>
</section>
<section id="energy-spectral-density">
<h3>Energy Spectral Density<a class="headerlink" href="#energy-spectral-density" title="Permalink to this heading"></a></h3>
<p>All the above examples were transformed to the Power Spectral Density (PSD).
PSD is appropriate for signals that are (roughly) periodic.
However, if your signal is limited in the time domain, it makes sense to compute the Energy Spectral Density (ESD, see <a class="reference external" href="https://en.wikipedia.org/wiki/Spectral_density">wikipedia</a> for discussion).</p>
<p>So, for a signal that has a clear start and end:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">DURATION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n_chan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="s1">&#39;sine&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DURATION</span><span class="p">))</span>
    <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="n">hann</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitude (V)&#39;</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">traces</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</pre></div>
</div>
<div>                            <div id="459d0479-8bea-47f0-9115-eac95caf5f4a" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("459d0479-8bea-47f0-9115-eac95caf5f4a")) {                    Plotly.newPlot(                        "459d0479-8bea-47f0-9115-eac95caf5f4a",                        [{"x":[0.0,0.00390625,0.0078125,0.01171875,0.015625,0.01953125,0.0234375,0.02734375,0.03125,0.03515625,0.0390625,0.04296875,0.046875,0.05078125,0.0546875,0.05859375,0.0625,0.06640625,0.0703125,0.07421875,0.078125,0.08203125,0.0859375,0.08984375,0.09375,0.09765625,0.1015625,0.10546875,0.109375,0.11328125,0.1171875,0.12109375,0.125,0.12890625,0.1328125,0.13671875,0.140625,0.14453125,0.1484375,0.15234375,0.15625,0.16015625,0.1640625,0.16796875,0.171875,0.17578125,0.1796875,0.18359375,0.1875,0.19140625,0.1953125,0.19921875,0.203125,0.20703125,0.2109375,0.21484375,0.21875,0.22265625,0.2265625,0.23046875,0.234375,0.23828125,0.2421875,0.24609375,0.25,0.25390625,0.2578125,0.26171875,0.265625,0.26953125,0.2734375,0.27734375,0.28125,0.28515625,0.2890625,0.29296875,0.296875,0.30078125,0.3046875,0.30859375,0.3125,0.31640625,0.3203125,0.32421875,0.328125,0.33203125,0.3359375,0.33984375,0.34375,0.34765625,0.3515625,0.35546875,0.359375,0.36328125,0.3671875,0.37109375,0.375,0.37890625,0.3828125,0.38671875,0.390625,0.39453125,0.3984375,0.40234375,0.40625,0.41015625,0.4140625,0.41796875,0.421875,0.42578125,0.4296875,0.43359375,0.4375,0.44140625,0.4453125,0.44921875,0.453125,0.45703125,0.4609375,0.46484375,0.46875,0.47265625,0.4765625,0.48046875,0.484375,0.48828125,0.4921875,0.49609375,0.5,0.50390625,0.5078125,0.51171875,0.515625,0.51953125,0.5234375,0.52734375,0.53125,0.53515625,0.5390625,0.54296875,0.546875,0.55078125,0.5546875,0.55859375,0.5625,0.56640625,0.5703125,0.57421875,0.578125,0.58203125,0.5859375,0.58984375,0.59375,0.59765625,0.6015625,0.60546875,0.609375,0.61328125,0.6171875,0.62109375,0.625,0.62890625,0.6328125,0.63671875,0.640625,0.64453125,0.6484375,0.65234375,0.65625,0.66015625,0.6640625,0.66796875,0.671875,0.67578125,0.6796875,0.68359375,0.6875,0.69140625,0.6953125,0.69921875,0.703125,0.70703125,0.7109375,0.71484375,0.71875,0.72265625,0.7265625,0.73046875,0.734375,0.73828125,0.7421875,0.74609375,0.75,0.75390625,0.7578125,0.76171875,0.765625,0.76953125,0.7734375,0.77734375,0.78125,0.78515625,0.7890625,0.79296875,0.796875,0.80078125,0.8046875,0.80859375,0.8125,0.81640625,0.8203125,0.82421875,0.828125,0.83203125,0.8359375,0.83984375,0.84375,0.84765625,0.8515625,0.85546875,0.859375,0.86328125,0.8671875,0.87109375,0.875,0.87890625,0.8828125,0.88671875,0.890625,0.89453125,0.8984375,0.90234375,0.90625,0.91015625,0.9140625,0.91796875,0.921875,0.92578125,0.9296875,0.93359375,0.9375,0.94140625,0.9453125,0.94921875,0.953125,0.95703125,0.9609375,0.96484375,0.96875,0.97265625,0.9765625,0.98046875,0.984375,0.98828125,0.9921875,0.99609375,1.0,1.00390625,1.0078125,1.01171875,1.015625,1.01953125,1.0234375,1.02734375,1.03125,1.03515625,1.0390625,1.04296875,1.046875,1.05078125,1.0546875,1.05859375,1.0625,1.06640625,1.0703125,1.07421875,1.078125,1.08203125,1.0859375,1.08984375,1.09375,1.09765625,1.1015625,1.10546875,1.109375,1.11328125,1.1171875,1.12109375,1.125,1.12890625,1.1328125,1.13671875,1.140625,1.14453125,1.1484375,1.15234375,1.15625,1.16015625,1.1640625,1.16796875,1.171875,1.17578125,1.1796875,1.18359375,1.1875,1.19140625,1.1953125,1.19921875,1.203125,1.20703125,1.2109375,1.21484375,1.21875,1.22265625,1.2265625,1.23046875,1.234375,1.23828125,1.2421875,1.24609375,1.25,1.25390625,1.2578125,1.26171875,1.265625,1.26953125,1.2734375,1.27734375,1.28125,1.28515625,1.2890625,1.29296875,1.296875,1.30078125,1.3046875,1.30859375,1.3125,1.31640625,1.3203125,1.32421875,1.328125,1.33203125,1.3359375,1.33984375,1.34375,1.34765625,1.3515625,1.35546875,1.359375,1.36328125,1.3671875,1.37109375,1.375,1.37890625,1.3828125,1.38671875,1.390625,1.39453125,1.3984375,1.40234375,1.40625,1.41015625,1.4140625,1.41796875,1.421875,1.42578125,1.4296875,1.43359375,1.4375,1.44140625,1.4453125,1.44921875,1.453125,1.45703125,1.4609375,1.46484375,1.46875,1.47265625,1.4765625,1.48046875,1.484375,1.48828125,1.4921875,1.49609375,1.5,1.50390625,1.5078125,1.51171875,1.515625,1.51953125,1.5234375,1.52734375,1.53125,1.53515625,1.5390625,1.54296875,1.546875,1.55078125,1.5546875,1.55859375,1.5625,1.56640625,1.5703125,1.57421875,1.578125,1.58203125,1.5859375,1.58984375,1.59375,1.59765625,1.6015625,1.60546875,1.609375,1.61328125,1.6171875,1.62109375,1.625,1.62890625,1.6328125,1.63671875,1.640625,1.64453125,1.6484375,1.65234375,1.65625,1.66015625,1.6640625,1.66796875,1.671875,1.67578125,1.6796875,1.68359375,1.6875,1.69140625,1.6953125,1.69921875,1.703125,1.70703125,1.7109375,1.71484375,1.71875,1.72265625,1.7265625,1.73046875,1.734375,1.73828125,1.7421875,1.74609375,1.75,1.75390625,1.7578125,1.76171875,1.765625,1.76953125,1.7734375,1.77734375,1.78125,1.78515625,1.7890625,1.79296875,1.796875,1.80078125,1.8046875,1.80859375,1.8125,1.81640625,1.8203125,1.82421875,1.828125,1.83203125,1.8359375,1.83984375,1.84375,1.84765625,1.8515625,1.85546875,1.859375,1.86328125,1.8671875,1.87109375,1.875,1.87890625,1.8828125,1.88671875,1.890625,1.89453125,1.8984375,1.90234375,1.90625,1.91015625,1.9140625,1.91796875,1.921875,1.92578125,1.9296875,1.93359375,1.9375,1.94140625,1.9453125,1.94921875,1.953125,1.95703125,1.9609375,1.96484375,1.96875,1.97265625,1.9765625,1.98046875,1.984375,1.98828125,1.9921875,1.99609375],"y":[0.0,1.8492008178255143e-05,7.554266016888504e-05,0.00016332226372377684,0.0002611238526719376,0.0003378859195096965,0.0003564370637468808,0.00027901186670332143,7.34287019766027e-05,-0.0002807801547678934,-0.0007870267762928049,-0.0014278116498640226,-0.002162935377102868,-0.002930180224242044,-0.00364863471789847,-0.0042245755338063875,-0.0045595549232581405,-0.0045600932179438065,-0.004148168317269407,-0.003271548603877881,-0.0019129489974474263,-9.70122391139349e-05,0.0021057678744714576,0.004578862411808416,0.007163666198956497,0.009667670570046739,0.011876557464853861,0.01356955754996332,0.014537079520646111,0.014599341439238923,0.013624544551721029,0.011545046598243222,0.008370028765411947,0.004193312709955939,-0.0008047336698519043,-0.006361875852326336,-0.012145483873914547,-0.017770484361408906,-0.02282295433316468,-0.026888018236233362,-0.02958027954072441,-0.030574694649474737,-0.02963561106504414,-0.02664166607127113,-0.021604388112821005,-0.014678659771164223,-0.006163675077446506,0.0035063712331335614,0.013781926243962754,0.024027370479988458,0.033558533848124586,0.04168632767871867,0.04776381278692364,0.051233610661234275,0.0516723495016316,0.048828844935768285,0.042652958146343525,0.03331254690931126,0.02119660610274771,0.006903546187603812,-0.00878547032321269,-0.024947185486124065,-0.040568929569906854,-0.05461043180571028,-0.06607107680304646,-0.07405835753463802,-0.07785297147060581,-0.07696599887280639,-0.07118390582205508,-0.06059772279423427,-0.04561363483312347,-0.026943333693868695,-0.005573760131701791,0.017282773767430083,0.04025573526805803,0.06189718729276726,0.08077158828700264,0.09554908482349396,0.10509632874319103,0.10855875029014803,0.10542851751142707,0.09559310632097477,0.07936046458538756,0.05745812132818411,0.03100518988490698,0.001457944523591215,-0.029468595801813286,-0.05989898030152952,-0.0879099816071026,-0.11165088955956033,-0.12946398509332613,-0.13999744015757054,-0.1423030886962174,-0.13591221191248154,-0.12088365013306393,-0.09782013346017042,-0.06785062503088453,-0.032578581079413554,0.006001779214165396,0.04561697354456316,0.0838473791778794,0.11827423816506996,0.14663165764171113,0.1669541054979025,0.17770988046130887,0.1779116250623386,0.1671961306882935,0.14586739778968644,0.11489906691953745,0.07589480224716798,0.031007839274739806,-0.017176461314804787,-0.06578875003970269,-0.11184608079919611,-0.15243447014126438,-0.18489247608236306,-0.20698426948237073,-0.21705101346294933,-0.21413042823882597,-0.19803615134848138,-0.1693908138192906,-0.12960950919274133,-0.0808333706958265,-0.025816106245028177,0.032230625207989375,0.08982437421810899,0.14342071465315906,0.1896311965348112,0.22543704266015402,0.2483851357742705,0.2567536310307273,0.2496761321240895,0.22721570614079517,0.190382950896129,0.14109569734049235,0.08208152560133747,0.016727874719272038,-0.05111209358131775,-0.11734677518234969,-0.1778931374944855,-0.22892853946273276,-0.2671318160450726,-0.2898984315175513,-0.29551580954733253,-0.28328714642744407,-0.2535949868728022,-0.20789941798324227,-0.14866970384875666,-0.07925229972756655,-0.003682195827736833,0.07355180652491516,0.14777422422138792,0.21440650123516738,0.2692498583814242,0.30874988267360376,0.3302261770518676,0.33205226542658617,0.31377377519254895,0.27615653927680617,0.22116045980884283,0.15183950334141386,0.07217277636206863,-0.013164024790119112,-0.09907365782401135,-0.18034265728377175,-0.2519585961281077,-0.30941992557157516,-0.3490191969801552,-0.36808182600871137,-0.36514504075288445,-0.34006512450649234,-0.29404531836808295,-0.2295815362880068,-0.15032807541370777,-0.060890468957151236,0.03344278157033038,0.1270139326396322,0.21413651252691282,0.2894420575825782,0.3482118580282796,0.38667315461192603,0.4022411593567991,0.39369137916668057,0.3612508220634104,0.30660152033333893,0.23279512129176821,0.144082751208279,0.04566961542168877,-0.05659146941965607,-0.15654950501232345,-0.24812676028182315,-0.32568972015341535,-0.3843968087469975,-0.4205013527875247,-0.4315907802316846,-0.41674677346050276,-0.3766157977191768,-0.313384823115634,-0.230662826028394,-0.1332744409429143,-0.026977579966650567,0.08187839422878018,0.1867335654030612,0.28121448282089606,0.3595231717320837,0.4167942945785372,0.4493983791764685,0.45517215750135226,0.43356137470160805,0.38566667600365484,0.31418904323103325,0.22327737640470724,0.11828682440452529,0.005461991509103251,-0.10843615924847426,-0.2165373138226033,-0.31227811269394107,-0.38980241484324185,-0.44432100388444135,-0.4724085511886972,-0.4722193556907233,-0.4436082390159798,-0.38814869561981863,-0.30904663411256333,-0.21095441759128877,-0.09969602704235116,0.018080344105571546,0.13530144417672077,0.2448957876390092,0.34022227200632393,0.41547448665467623,0.46603598670999974,0.48876469793149147,0.4821888589107328,0.44660224002898,0.3840524814280022,0.298222893245788,0.1942145632868875,0.07824172151043914,-0.04274135821829606,-0.16145940982578885,-0.27075580656741866,-0.36402607817806115,-0.4356189273332285,-0.4811802805981188,-0.4979193299748224,-0.4847802351221501,-0.44250887709372905,-0.37361043345328965,-0.28220019231181664,-0.1737565325177148,-0.054790970135955665,0.06754475887635504,0.18589075460125434,0.29312391883445443,0.38278879787361997,0.4494881161584854,0.4892092600355066,0.4995668665410905,0.47994677974175687,0.43154264440449525,0.35728294599601274,0.2616529770546084,0.15042260470334534,0.030296441455151975,-0.09149226838712597,-0.20761932878434847,-0.31111222643437186,-0.3957708393117611,-0.45654071078341235,-0.4898163067237759,-0.49365597176811943,-0.46789570725820123,-0.41415507502416415,-0.33573510849648913,-0.23741468284560568,-0.1251579572971929,-0.005750879821653365,0.11361098963114519,0.22575818405392228,0.32398005409304226,0.4024282694159665,0.456466717900311,0.4829467680415053,0.48039147475222777,0.4490779075532506,0.39101301728757976,0.30980494937515307,0.21043806059023057,0.09896571506340776,-0.017860129555638635,-0.13299978070199878,-0.2395520001094999,-0.3311696023251172,-0.4024393177914396,-0.44920308067935283,-0.46880158619686224,-0.4602257938465404,-0.42416773061367385,-0.3629681197570416,-0.28046464687713596,-0.18175069057836601,-0.07285972448357302,0.03960498405580443,0.14887255927660908,0.24841398490360064,0.3323339822248546,0.39572167240447037,0.43493907424611855,0.44783042269575624,0.4338402348677528,0.3940336899110696,0.33101887676473074,0.24877643127604857,0.15240766686035906,0.04781716289947209,-0.058650378571214336,-0.1605965911464498,-0.2519555831697119,-0.3273563572364597,-0.38243976724803946,-0.41411123757877943,-0.42071455272385033,-0.4021169660038071,-0.35970136245277584,-0.2962669033099841,-0.21584512764072034,-0.12344355286938843,-0.0247330956457872,0.07430112598410224,0.1677240357776835,0.25000763930763054,0.31635930090048653,0.363001693067516,0.38738801959737085,0.38834024237398457,0.36610287056421975,0.32231009559064316,0.2598693519936332,0.1827694280334844,0.09582573523002469,0.004379005493669329,-0.08603369545400576,-0.1700153161115299,-0.24263203173514725,-0.29970390281528836,-0.33804580970886355,-0.3556447594092527,-0.3517637293583485,-0.3269668250342956,-0.28306539275999304,-0.22298954524372405,-0.150594030493355,-0.07041123591906588,0.01263285886784293,0.09352195743594731,0.16745323725033343,0.23012321040203826,0.2779785994041055,0.30841758342158376,0.31993003649593804,0.3121692872689329,0.28595222920499597,0.24318903109749432,0.18674796642043934,0.12026473743551075,0.04790888615378376,-0.025877727058120727,-0.0966539674032678,-0.16024718362924997,-0.21299950925428998,-0.25197815223107445,-0.2751375951923048,-0.28142479804562,-0.2708221490268001,-0.24432681538349477,-0.20386905557779467,-0.15217573051173824,-0.09258847019966866,-0.028848525472513525,0.0351378837265612,0.09553901472564717,0.1488271591038535,0.19198455187998223,0.22267362516562772,0.23936204854323087,0.2413959815452365,0.22901828409743516,0.2033318762117772,0.16621179301013533,0.12017254012851876,0.06819993540330936,0.01355857695948882,-0.04041270082997429,-0.09050459183703113,-0.13382788013571106,-0.1679795019227232,-0.19117460401324543,-0.20233743059153633,-0.20114658766126348,-0.1880331568790211,-0.16413307060804266,-0.1311979350855045,-0.09147093046768646,-0.04753638220415312,-0.0021529781269617448,0.04191867028176194,0.08208338300858331,0.11606356949409725,0.1420273112351014,0.15868524123654446,0.16535123438871735,0.16196431108438844,0.1490716346633623,0.12777489399249872,0.09964455683261374,0.0666083267049549,0.03082153053687169,-0.005471967153575069,-0.04007942360204743,-0.07099081232879667,-0.09649450753836535,-0.11527047066454466,-0.12645597931827673,-0.12968082258532282,-0.125070898770542,-0.1132211609816482,-0.09514073551208187,-0.07217467335035009,-0.04590809117556572,-0.018059344564706127,0.009630688983631206,0.03550616776799728,0.05809410765939323,0.0761867623198684,0.08890405546243023,0.09573299735313022,0.09654259480404691,0.0915743732037236,0.08141016629693784,0.06692019859578342,0.04919560505998649,0.029470340829851067,0.009037890712837825,-0.010831721463657065,-0.02896939045382185,-0.04437421315659675,-0.05626682253538446,-0.06412606704090223,-0.0677075282503139,-0.06704361015186346,-0.06242613431874592,-0.05437345916991284,-0.04358504260974927,-0.03088703448671534,-0.017172885145023045,-0.0033430747234606166,0.009752089970428169,0.021363074731848376,0.030882200992657052,0.037873085529663134,0.04208719598483804,0.04346720396506493,0.04213771250706749,0.03838474293815226,0.03262603716846891,0.02537472652643043,0.017199212629364986,0.008682189715520473,0.00038161662078844283,-0.0072038605882428644,-0.013662996163968669,-0.01869207926221881,-0.02210629607899086,-0.023842162431389285,-0.023951502962776552,-0.022588014056212063,-0.01998790014639847,-0.016446391133056192,-0.01229211678781245,-0.007861328833218365,-0.0034738305427542953,0.0005877846861234293,0.004094343793818979,0.006880939482393562,0.008852056909850624,0.00998108426395097,0.010304727724173336,0.009913201211092572,0.008937320340390062,0.007533783463073696,0.005869964844267637,0.0041094791541480885,0.002399614093940925,0.00086148779801662,-0.0004165064292488569,-0.0013817263670685433,-0.0020168561608782842,-0.0023364006542929837,-0.002380709984856782,-0.0022083182592882223,-0.0018874728447417222,-0.0014877395854923764,-0.0010724973263351307,-0.0006929925503099656,-0.0003844275309561423,-0.00016432322454377335,-3.315368573429508e-05,2.2984971225973237e-05,2.810971472269375e-05,1.1080023104909342e-05,0.0],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"title":{"text":"Time (s)"}},"yaxis":{"title":{"text":"Amplitude (V)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
<p>You can compute the ESD in this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">freq</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitude (V&lt;sup&gt;2&lt;/sup&gt;)&#39;</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">traces</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</pre></div>
</div>
<div>                            <div id="c826f55d-ec68-4425-ac0c-d09c35efc174" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c826f55d-ec68-4425-ac0c-d09c35efc174")) {                    Plotly.newPlot(                        "c826f55d-ec68-4425-ac0c-d09c35efc174",                        [{"x":[0.0,0.5,1.0,1.5,2.0,2.5,3.0,3.5,4.0,4.5,5.0,5.5,6.0,6.5,7.0,7.5,8.0,8.5,9.0,9.5,10.0,10.5,11.0,11.5,12.0,12.5,13.0,13.5,14.0,14.5,15.0,15.5,16.0,16.5,17.0,17.5,18.0,18.5,19.0,19.5,20.0,20.5,21.0,21.5,22.0,22.5,23.0,23.5,24.0,24.5,25.0,25.5,26.0,26.5,27.0,27.5,28.0,28.5,29.0,29.5,30.0,30.5,31.0,31.5,32.0,32.5,33.0,33.5,34.0,34.5,35.0,35.5,36.0,36.5,37.0,37.5,38.0,38.5,39.0,39.5,40.0,40.5,41.0,41.5,42.0,42.5,43.0,43.5,44.0,44.5,45.0,45.5,46.0,46.5,47.0,47.5,48.0,48.5,49.0,49.5,50.0,50.5,51.0,51.5,52.0,52.5,53.0,53.5,54.0,54.5,55.0,55.5,56.0,56.5,57.0,57.5,58.0,58.5,59.0,59.5,60.0,60.5,61.0,61.5,62.0,62.5,63.0,63.5,64.0,64.5,65.0,65.5,66.0,66.5,67.0,67.5,68.0,68.5,69.0,69.5,70.0,70.5,71.0,71.5,72.0,72.5,73.0,73.5,74.0,74.5,75.0,75.5,76.0,76.5,77.0,77.5,78.0,78.5,79.0,79.5,80.0,80.5,81.0,81.5,82.0,82.5,83.0,83.5,84.0,84.5,85.0,85.5,86.0,86.5,87.0,87.5,88.0,88.5,89.0,89.5,90.0,90.5,91.0,91.5,92.0,92.5,93.0,93.5,94.0,94.5,95.0,95.5,96.0,96.5,97.0,97.5,98.0,98.5,99.0,99.5,100.0,100.5,101.0,101.5,102.0,102.5,103.0,103.5,104.0,104.5,105.0,105.5,106.0,106.5,107.0,107.5,108.0,108.5,109.0,109.5,110.0,110.5,111.0,111.5,112.0,112.5,113.0,113.5,114.0,114.5,115.0,115.5,116.0,116.5,117.0,117.5,118.0,118.5,119.0,119.5,120.0,120.5,121.0,121.5,122.0,122.5,123.0,123.5,124.0,124.5,125.0,125.5,126.0,126.5,127.0,127.5,128.0],"y":[1.0561010360921615e-12,2.1535076987740384e-12,2.281702287654145e-12,2.510416163988458e-12,2.865258674528129e-12,3.3890798907370864e-12,4.151611453448758e-12,5.267035340573361e-12,6.9268198492525955e-12,9.463668719708711e-12,1.3482831672439141e-11,2.014977935255235e-11,3.187239663140484e-11,5.40862490800629e-11,1.0055474441285957e-10,2.11993354243321e-10,5.392796211606168e-10,1.888064098964681e-09,1.3407992212878126e-08,0.007828739158567091,0.031132344477979385,0.007828740720421404,1.3403873401881253e-08,1.8857165634699238e-09,5.375773461795884e-10,2.1062895606262917e-10,9.939572291479143e-11,5.306176336833979e-11,3.093915786396574e-11,1.927860466633646e-11,1.2652359813736174e-11,8.657029342368197e-12,6.129665732989844e-12,4.466244226772235e-12,3.334315847024982e-12,2.541832415000844e-12,1.9732040359129066e-12,1.5563614772287692e-12,1.2449711040160622e-12,1.0084323660806893e-12,8.260484378507383e-13,6.835206057157201e-13,5.707804554411096e-13,4.806154425524938e-13,4.07777670721743e-13,3.4839411261157057e-13,2.995690213641274e-13,2.5911132826180504e-13,2.2534481163957972e-13,1.9697400079825191e-13,1.729881910033223e-13,1.5259189189231556e-13,1.3515385219034605e-13,1.2016930180082551e-13,1.0723170402881268e-13,9.601142753488925e-14,8.623950011048322e-14,7.769513327261753e-14,7.019606707557483e-14,6.359104396313376e-14,5.775390088263088e-14,5.257890206964329e-14,4.797702859434549e-14,4.387301149252707e-14,4.020294616223321e-14,3.691236390643586e-14,3.3954664929650397e-14,3.128983936802116e-14,2.888341798842639e-14,2.6705608079109767e-14,2.4730578288207128e-14,2.2935864919573508e-14,2.1301876578329443e-14,1.9811479853590033e-14,1.844965111240687e-14,1.7203182921587668e-14,1.6060436516488332e-14,1.501113058027414e-14,1.4046162678204042e-14,1.3157456248447491e-14,1.2337829769009854e-14,1.15808845761554e-14,1.0880908179231562e-14,1.0232791038194881e-14,9.63195435893724e-15,9.074287783400308e-15,8.556094907864881e-15,8.074046201360811e-15,7.625137590421067e-15,7.206654468272053e-15,6.816140000907635e-15,6.451367409746473e-15,6.110315486476086e-15,5.791147089205415e-15,5.492190090591424e-15,5.211920569000974e-15,4.9489478867132186e-15,4.702001464449113e-15,4.469918982798955e-15,4.251635942206548e-15,4.0461762739972825e-15,3.8526440312561445e-15,3.670215872483387e-15,3.498134429172456e-15,3.3357022407304763e-15,3.182276420070204e-15,3.037263765764704e-15,2.9001164110367022e-15,2.770327881048587e-15,2.6474295489065987e-15,2.5309873957389783e-15,2.4205991383279565e-15,2.315891548871439e-15,2.216518143457351e-15,2.1221568457947623e-15,2.0325082702806924e-15,1.9472937118388567e-15,1.866253517815263e-15,1.7891458025438392e-15,1.7157448194493022e-15,1.6458399184854663e-15,1.5792342913731795e-15,1.51574400715707e-15,1.4551969905998447e-15,1.3974322193558654e-15,1.3422988474234706e-15,1.2896555500639689e-15,1.239369753549973e-15,1.1913171083592475e-15,1.1453808351688032e-15,1.1014512520639092e-15,1.0594252477076175e-15,1.0192058643808357e-15,9.807018543293789e-16,9.438273199867922e-16,9.085013370568736e-16,8.746476457478048e-16,8.421943282691199e-16,8.1107354864492e-16,7.812212598807048e-16,7.525769981853403e-16,7.250836248077497e-16,6.986871424418793e-16,6.733364759840496e-16,6.489833186859401e-16,6.255819357799193e-16,6.030890336749477e-16,5.814635863692516e-16,5.606667275881304e-16,5.406615988143887e-16,5.214132483936901e-16,5.028885069035438e-16,4.850558928906865e-16,4.678855129284491e-16,4.513489702254067e-16,4.354192788239561e-16,4.200707806043196e-16,4.052790920447134e-16,3.910209945232027e-16,3.7727441426751697e-16,3.640183216323268e-16,3.512327008931144e-16,3.3889848083189437e-16,3.269974931260638e-16,3.1551241453142287e-16,3.0442673624505325e-16,2.9372469909545965e-16,2.8339128599561476e-16,2.7341214952211077e-16,2.637736020147765e-16,2.544625779329244e-16,2.454665815476914e-16,2.3677369278457386e-16,2.2837250832548963e-16,2.2025213554609524e-16,2.1240215140027097e-16,2.048125957285405e-16,1.9747393411450646e-16,1.9037704868538986e-16,1.8351320770583914e-16,1.7687405686138888e-16,1.7045159532361566e-16,1.6423816037664688e-16,1.582264120266748e-16,1.5240931738185676e-16,1.4678013819332708e-16,1.4133241486678166e-16,1.3605995469384954e-16,1.3095681975354385e-16,1.2601731808397072e-16,1.2123598612010131e-16,1.1660758590550841e-16,1.1212709008705143e-16,1.0778967464437092e-16,1.0359071119076248e-16,9.952575446599847e-17,9.559054001070041e-17,9.178097032285056e-17,8.809311606801758e-17,8.452319762374773e-17,8.106758986783165e-17,7.772280935616678e-17,7.44855109118094e-17,7.135247986307036e-17,6.83206306878609e-17,6.53869958213213e-17,6.25487305577475e-17,5.980309085032162e-17,5.714745675270195e-17,5.457929991319786e-17,5.209618655126325e-17,4.9695800830203907e-17,4.7375893832919745e-17,4.513432193745265e-17,4.296901910443088e-17,4.087800607410635e-17,3.885937917616351e-17,3.69113147990474e-17,3.503206012210022e-17,3.3219936361185593e-17,3.147333040540017e-17,2.9790700202982135e-17,2.8170562636751005e-17,2.6611501089844217e-17,2.511215683087445e-17,2.3671230248682522e-17,2.2287478086825836e-17,2.0959711559846413e-17,1.9686795305143015e-17,1.8467645106799434e-17,1.730122745270968e-17,1.6186556631649623e-17,1.5122694798561787e-17,1.4108750240352803e-17,1.314387563382269e-17,1.2227267912029153e-17,1.135816618306487e-17,1.0535852072138028e-17,9.759646577558306e-18,9.028911994292477e-18,8.343048484391837e-18,7.701495020040354e-18,7.10372839145953e-18,6.5492611688477705e-18,6.037643369269268e-18,5.5684595370768845e-18,5.141330374285851e-18,4.755910071493426e-18,4.411888247489647e-18,4.108986777244872e-18,3.846963154962947e-18,3.6256052405208805e-18,3.4447362565010107e-18,3.304210377391585e-18,3.2039152488481266e-18,3.1437703668240023e-18,1.5618636816707031e-18],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"range":[0,20],"title":{"text":"Frequency (Hz)"}},"yaxis":{"title":{"text":"Amplitude (V<sup>2</sup>)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The units for the PSD are V<sup>2</sup>/ Hz while those for the ESD are V<sup>2</sup>.</p>
</div>
<p>The Parseval’s theorem holds in this case as well, but we need to make sure to include the duration as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">p_time</span> <span class="o">=</span> <span class="n">math</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">operator_name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">p_freq</span> <span class="o">=</span> <span class="n">math</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">operator_name</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">)</span>
    <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">p_time</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">p_freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">s_freq</span> <span class="o">*</span> <span class="n">DURATION</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="complex-output">
<h3>Complex Output<a class="headerlink" href="#complex-output" title="Permalink to this heading"></a></h3>
<p>To get the complex output (so, not the PSD or ESD), you should pass the argument <code class="docutils literal notranslate"><span class="pre">output='complex'</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">data</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n_chan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="s1">&#39;sine&#39;</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">,</span> <span class="n">sides</span><span class="o">=</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>

    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">freq</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">freq</span><span class="p">(</span><span class="n">trial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chan</span><span class="o">=</span><span class="s1">&#39;chan00&#39;</span><span class="p">,</span> <span class="n">taper</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
        <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span>
            <span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Amplitude (V)&#39;</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">traces</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</pre></div>
</div>
<div>                            <div id="e4958b5f-a606-4e57-9008-d6a05fbdd7a1" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4958b5f-a606-4e57-9008-d6a05fbdd7a1")) {                    Plotly.newPlot(                        "e4958b5f-a606-4e57-9008-d6a05fbdd7a1",                        [{"x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0,105.0,106.0,107.0,108.0,109.0,110.0,111.0,112.0,113.0,114.0,115.0,116.0,117.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,125.0,126.0,127.0,-128.0,-127.0,-126.0,-125.0,-124.0,-123.0,-122.0,-121.0,-120.0,-119.0,-118.0,-117.0,-116.0,-115.0,-114.0,-113.0,-112.0,-111.0,-110.0,-109.0,-108.0,-107.0,-106.0,-105.0,-104.0,-103.0,-102.0,-101.0,-100.0,-99.0,-98.0,-97.0,-96.0,-95.0,-94.0,-93.0,-92.0,-91.0,-90.0,-89.0,-88.0,-87.0,-86.0,-85.0,-84.0,-83.0,-82.0,-81.0,-80.0,-79.0,-78.0,-77.0,-76.0,-75.0,-74.0,-73.0,-72.0,-71.0,-70.0,-69.0,-68.0,-67.0,-66.0,-65.0,-64.0,-63.0,-62.0,-61.0,-60.0,-59.0,-58.0,-57.0,-56.0,-55.0,-54.0,-53.0,-52.0,-51.0,-50.0,-49.0,-48.0,-47.0,-46.0,-45.0,-44.0,-43.0,-42.0,-41.0,-40.0,-39.0,-38.0,-37.0,-36.0,-35.0,-34.0,-33.0,-32.0,-31.0,-30.0,-29.0,-28.0,-27.0,-26.0,-25.0,-24.0,-23.0,-22.0,-21.0,-20.0,-19.0,-18.0,-17.0,-16.0,-15.0,-14.0,-13.0,-12.0,-11.0,-10.0,-9.0,-8.0,-7.0,-6.0,-5.0,-4.0,-3.0,-2.0,-1.0],"y":[3.133344278483108e-17,0.012209501087798669,0.006105210255003186,0.0040706510319229484,0.0030535247920796546,0.002443371836079289,0.002036705619078001,0.0017463176404286472,0.001528603666100601,0.0013593391361595643,0.24907596119852835,0.0011133048838163453,0.001021119577269772,0.0009431644919427881,0.0008763904115409341,0.0008185612530814938,0.0007679999627868687,0.0007234240957840904,0.0006838362025755073,0.0006484488303109102,0.000616632023682387,0.0005878758255661176,0.0005617630047657632,0.0005379488982601727,0.000516146292892738,0.0004961139354578804,0.00047764769430931343,0.0004605736850579551,0.00044474286933782507,0.00043002677107093347,0.00041631404948228707,0.0004035077354050248,0.0003915229857808537,0.00038028524643604736,0.0003697287390757377,0.00035979520765364026,0.00035043287368274607,0.00034159556095711966,0.000333241958479036,0.0003253349967839001,0.0003178413178192171,0.0003107308224049403,0.00030397628234475144,0.0002975530066642709,0.00029143855336461464,0.000285612479611624,0.0002800561245114945,0.00027475241962045445,0.0002696857231426948,0.0002648416744339212,0.0002602070659667485,0.0002557697303623241,0.0002515184404590032,0.0002474428206973186,0.00024353326835355537,0.000239780883369263,0.0002361774057018603,0.00023271515927283587,0.0002293870017175258,0.0002261862792482849,0.00022310678603425555,0.00022014272758017479,0.00021728868765154315,0.00021453959835439034,0.0002118907130221974,0.00020933758160974114,0.00020687602832705705,0.00020450213128006176,0.00020221220391113237,0.00020000277805721183,0.00019787058846409036,0.0001958125586129934,0.0001938257877324546,0.0001919075388815313,0.0001900552280036807,0.0001882664138603589,0.00018653878876393257,0.0001848701700366907,0.00018325849213232537,0.00018170179935935406,0.0001801982391557403,0.0001787460558673201,0.00017734358498466105,0.00017598924780376642,0.00017468154647249195,0.00017341905939163033,0.00017220043694428786,0.00017102439752388608,0.00016988972383964154,0.00016879525947758434,0.00016773990569661168,0.00016672261844311655,0.0001657424055662967,0.00016479832422074047,0.00016388947844156603,0.00016301501688062816,0.00016217413069123332,0.00016136605155252077,0.00016059004982202797,0.00015984543280956188,0.00015913154316289727,0.00015844775735862773,0.00015779348429120996,0.00015716816395362754,0.00015657126620521254,0.00015600228961874297,0.0001554607604047544,0.00015494623140786806,0.00015445828116882236,0.0001539965130518596,0.0001535605544312245,0.00015315005593559777,0.00015276469074540332,0.00015240415394278902,0.00015206816190936487,0.00015175645177135247,0.0001514687808890502,0.000151204926388932,0.00015096468473685867,0.0001507478713506851,0.00015055432025116108,0.00015038388374928773,0.00015023643216988252,0.000150111853609296,0.00015001005372782791,0.00014993095557460647,0.00014987449944564053,0.00014984064277330207,0.00014982936004849458,0.00014984064277330207,0.00014987449944564053,0.00014993095557460647,0.00015001005372782791,0.000150111853609296,0.00015023643216988252,0.00015038388374928773,0.00015055432025116108,0.0001507478713506851,0.00015096468473685867,0.000151204926388932,0.0001514687808890502,0.00015175645177135247,0.00015206816190936487,0.00015240415394278902,0.00015276469074540332,0.00015315005593559777,0.0001535605544312245,0.0001539965130518596,0.00015445828116882236,0.00015494623140786806,0.0001554607604047544,0.00015600228961874297,0.00015657126620521254,0.00015716816395362754,0.00015779348429120996,0.00015844775735862773,0.00015913154316289727,0.00015984543280956188,0.00016059004982202797,0.00016136605155252077,0.00016217413069123332,0.00016301501688062816,0.00016388947844156603,0.00016479832422074047,0.0001657424055662967,0.00016672261844311655,0.00016773990569661168,0.00016879525947758434,0.00016988972383964154,0.00017102439752388608,0.00017220043694428786,0.00017341905939163033,0.00017468154647249195,0.00017598924780376642,0.00017734358498466105,0.0001787460558673201,0.0001801982391557403,0.00018170179935935406,0.00018325849213232537,0.0001848701700366907,0.00018653878876393257,0.0001882664138603589,0.0001900552280036807,0.0001919075388815313,0.0001938257877324546,0.0001958125586129934,0.00019787058846409036,0.00020000277805721183,0.00020221220391113237,0.00020450213128006176,0.00020687602832705705,0.00020933758160974114,0.0002118907130221974,0.00021453959835439034,0.00021728868765154315,0.00022014272758017479,0.00022310678603425555,0.0002261862792482849,0.0002293870017175258,0.00023271515927283587,0.0002361774057018603,0.000239780883369263,0.00024353326835355537,0.0002474428206973186,0.0002515184404590032,0.0002557697303623241,0.0002602070659667485,0.0002648416744339212,0.0002696857231426948,0.00027475241962045445,0.0002800561245114945,0.000285612479611624,0.00029143855336461464,0.0002975530066642709,0.00030397628234475144,0.0003107308224049403,0.0003178413178192171,0.0003253349967839001,0.000333241958479036,0.00034159556095711966,0.00035043287368274607,0.00035979520765364026,0.0003697287390757377,0.00038028524643604736,0.0003915229857808537,0.0004035077354050248,0.00041631404948228707,0.00043002677107093347,0.00044474286933782507,0.0004605736850579551,0.00047764769430931343,0.0004961139354578804,0.000516146292892738,0.0005379488982601727,0.0005617630047657632,0.0005878758255661176,0.000616632023682387,0.0006484488303109102,0.0006838362025755073,0.0007234240957840904,0.0007679999627868687,0.0008185612530814938,0.0008763904115409341,0.0009431644919427881,0.001021119577269772,0.0011133048838163453,0.24907596119852835,0.0013593391361595643,0.001528603666100601,0.0017463176404286472,0.002036705619078001,0.002443371836079289,0.0030535247920796546,0.0040706510319229484,0.006105210255003186,0.012209501087798669],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"title":{"text":"Frequency (Hz)"}},"yaxis":{"title":{"text":"Amplitude (V)"}}},                        {"responsive": true}                    )                };                            </script>        </div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The complex frequency domain returns positive and negative frequencies.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The complex output has an additional dimension, called <code class="docutils literal notranslate"><span class="pre">taper</span></code>.
This is necessary in the case of <code class="docutils literal notranslate"><span class="pre">taper='dpss'</span></code> because it does not make sense to average in the complex domain over multiple tapers.
For consistency, there is also a <code class="docutils literal notranslate"><span class="pre">taper</span></code> dimension also when using single tapers (such as <code class="docutils literal notranslate"><span class="pre">hann</span></code> or <code class="docutils literal notranslate"><span class="pre">boxcar</span></code>).</p>
</div>
</section>
<section id="comparison-to-scipy">
<h3>Comparison to Scipy<a class="headerlink" href="#comparison-to-scipy" title="Permalink to this heading"></a></h3>
<p>The code reflects quite some ideas from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, but the nomenclature in <code class="docutils literal notranslate"><span class="pre">scipy</span></code> might give rise to some confusion, especially if compared to other sources (well summarized by <a class="reference external" href="https://en.wikipedia.org/wiki/Spectral_density">wikipedia</a>).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>scipy parameters</p></th>
<th class="head"><p>wonambi parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Power Spectral Density</p></td>
<td><p>V<sup>2</sup>/ Hz</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='psd'</span></code>
<code class="docutils literal notranslate"><span class="pre">scaling='density'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='spectraldensity'</span></code>
<code class="docutils literal notranslate"><span class="pre">scaling='power'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Energy Spectral Density</p></td>
<td><p>V<sup>2</sup></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='psd'</span></code>
<code class="docutils literal notranslate"><span class="pre">scaling='spectrum'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='spectraldensity'</span></code>
<code class="docutils literal notranslate"><span class="pre">scaling='energy'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Complex Fourier</p></td>
<td><p>V</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='complex'</span></code>
<code class="docutils literal notranslate"><span class="pre">scaling='spectrum'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='complex'</span></code>
<code class="docutils literal notranslate"><span class="pre">scaling='energy'</span></code></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="time-frequency">
<h2>Time-Frequency<a class="headerlink" href="#time-frequency" title="Permalink to this heading"></a></h2>
<p>There are two main approaches to the time-frequency analysis:</p>
<blockquote>
<div><ul class="simple">
<li><p>Spectrogram / short-time Fourier transform</p></li>
<li><p>Morlet wavelets</p></li>
</ul>
</div></blockquote>
<section id="spectrogram-stft">
<h3>Spectrogram / STFT<a class="headerlink" href="#spectrogram-stft" title="Permalink to this heading"></a></h3>
<p>The first approach is identical to computing <code class="docutils literal notranslate"><span class="pre">frequency()</span></code> on small epochs.
The duration of the epochs is defined by <code class="docutils literal notranslate"><span class="pre">duration</span></code>, and you can specify either the <code class="docutils literal notranslate"><span class="pre">overlap</span></code> (between 0, no overlap, and 1, complete overlap) or the <code class="docutils literal notranslate"><span class="pre">step</span></code> (distance between epochs, in seconds).
The output of <code class="docutils literal notranslate"><span class="pre">timefrequency()</span></code> has a different name than the output of <code class="docutils literal notranslate"><span class="pre">frequency()</span></code> for consistency with the literature, so:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>timefrequency()</p></th>
<th class="head"><p>frequency()</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">output='spectrogram'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='spectraldensity'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">output='stft'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">output='complex'</span></code></p></td>
</tr>
</tbody>
</table>
<p>The other arguments of <code class="docutils literal notranslate"><span class="pre">timefrequency()</span></code> are the same as <code class="docutils literal notranslate"><span class="pre">frequency()</span></code>.</p>
</section>
<section id="wavelet">
<h3>Wavelet<a class="headerlink" href="#wavelet" title="Permalink to this heading"></a></h3>
<p>Morlet Wavelets can be used for time-frequency analysis and have an intuitive tradeoff between time and frequency resolution.
The catch is there is no straightforward way to normalize the output of the wavelets.
The Parseval’s theorem does not hold because wavelets are not orthogonal.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Get Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot3d.html" class="btn btn-neutral float-right" title="Plot 3D images" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2022, Gio Piantoni / Jordan O&#39;Byrne.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>